==17705== NVPROF is profiling process 17705, command: ./thrust_particle_filter -x 128 -y 128 -z 1000 -np 10000
==17705== Profiling application: ./thrust_particle_filter -x 128 -y 128 -z 1000 -np 10000
==17705== Profiling result:
Time(%)      Time     Calls       Avg       Min       Max  Name
 77.59%  4.02807s       999  4.0321ms  2.4359ms  4.0502ms  <get_indexYOYOYOYO>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
 11.65%  604.69ms       999  605.30us  584.38us  674.59us  binary_transform_functor<calc_likelihood_sumYOYOYOYO>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  7.82%  405.97ms       999  406.38us  394.62us  414.85us  wrapped_function<ind_calcYOYOYOYO, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.32%  16.432ms      1998  8.2240us  6.6880us  9.9520us  binary_transform_functor<randn_transformYOYOYOYO>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.23%  11.690ms       999  11.701us  11.488us  11.936us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=128, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=7>, unsigned long=128>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::reduce_detail::reduce_partitions, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=1>, thrust::detail::normal_iterator<thrust::device_ptr<double>>, thrust::system::cuda::detail::aligned_decomposition<long>, thrust::detail::normal_iterator<thrust::pointer<double, thrust::system::cuda::detail::tag, thrust::use_default, thrust::use_default>>, double, thrust::plus<double>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=7)
  0.19%  10.032ms       999  10.041us  9.6000us  10.688us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=128, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=7>, unsigned long=128>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::reduce_detail::reduce_partitions, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=1>, thrust::detail::normal_iterator<thrust::pointer<double, thrust::system::cuda::detail::tag, thrust::use_default, thrust::use_default>>, thrust::detail::normal_iterator<thrust::pointer<double, thrust::system::cuda::detail::tag, thrust::use_default, thrust::use_default>>, thrust::detail::normal_iterator<thrust::pointer<double, thrust::system::cuda::detail::tag, thrust::use_default, thrust::use_default>>, thrust::plus<double>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=7)
  0.17%  8.6356ms      3999  2.1590us  1.9840us  14.208us  [CUDA memcpy DtoH]
  0.16%  8.5232ms      1998  4.2650us  3.8400us  4.7040us  wrapped_function<normalize_weightsYOYOYOYO, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.15%  7.9922ms      1998  4.0000us  3.2640us  4.5440us  binary_transform_functor<update_coordsYOYOYOYO>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.15%  7.7860ms      2003  3.8870us     864ns  5.9408ms  [CUDA memcpy HtoD]
  0.10%  4.9683ms       999  4.9730us  4.6720us  5.3120us  binary_transform_functor<exp_transformYOYOYOYO>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.09%  4.8551ms       999  4.8590us  4.5760us  5.2480us  wrapped_function<update_uYOYOYOYO, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.06%  3.0288ms       999  3.0310us  2.8480us  3.2000us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::zip_iterator<thrust::tuple<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, long>, thrust::detail::normal_iterator<thrust::device_ptr<double>>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>, thrust::detail::wrapped_function<thrust::detail::unary_transform_functor<thrust::system::detail::generic::sequence_detail::sequence_functor<double>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.06%  2.9377ms       999  2.9400us  2.8160us  3.2000us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::detail::normal_iterator<thrust::device_ptr<double>>, thrust::detail::wrapped_function<thrust::detail::device_generate_functor<thrust::detail::fill_functor<double>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.00%  19.552us         2  9.7760us  2.8480us  16.704us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::device_ptr<int>, thrust::detail::wrapped_function<thrust::detail::device_generate_functor<thrust::detail::fill_functor<int>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.00%  16.224us         6  2.7040us  2.5280us  3.4880us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::device_ptr<double>, thrust::detail::wrapped_function<thrust::detail::device_generate_functor<thrust::detail::fill_functor<double>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)

==17705== API calls:
Time(%)      Time     Calls       Avg       Min       Max  Name
 85.46%  4.81239s       999  4.8172ms  759.95us  4.9042ms  cudaEventSynchronize
  4.34%  244.67ms      1012  241.77us  7.7920us  235.04ms  cudaMalloc
  3.30%  185.62ms     15992  11.607us  9.4470us  593.63us  cudaLaunch
  2.60%  146.22ms     57974  2.5220us  2.2350us  541.54us  cudaFuncGetAttributes
  2.58%  145.08ms      6002  24.172us  4.8310us  6.2685ms  cudaMemcpyAsync
  0.42%  23.562ms     15992  1.4730us  1.0970us  642.68us  cudaEventCreateWithFlags
  0.36%  20.433ms     45978     444ns     310ns  620.74us  cudaGetDevice
  0.29%  16.419ms     15992  1.0260us     855ns  12.618us  cudaEventRecord
  0.26%  14.369ms     15992     898ns     742ns  12.704us  cudaEventDestroy
  0.16%  8.7287ms      1012  8.6250us  6.6050us  178.06us  cudaFree
  0.12%  6.6414ms     15992     415ns     254ns  541.23us  cudaConfigureCall
  0.11%  5.9705ms     15992     373ns     303ns  11.320us  cudaSetupArgument
  0.01%  782.05us       166  4.7110us     219ns  180.08us  cuDeviceGetAttribute
  0.00%  101.29us         2  50.644us  44.974us  56.314us  cuDeviceTotalMem
  0.00%  77.290us         2  38.645us  37.909us  39.381us  cuDeviceGetName
  0.00%  8.1560us        11     741ns     402ns  3.1520us  cudaDeviceGetAttribute
  0.00%  4.2430us         2  2.1210us     728ns  3.5150us  cuDeviceGetCount
  0.00%  1.9180us         4     479ns     265ns     686ns  cuDeviceGet
