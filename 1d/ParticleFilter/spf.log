==6591== NVPROF is profiling process 6591, command: ./thrust_particle_filter -x 128 -y 128 -z 1000 -np 10000
==6591== Profiling application: ./thrust_particle_filter -x 128 -y 128 -z 1000 -np 10000
==6591== Profiling result:
Time(%)      Time     Calls       Avg       Min       Max  Name
 48.33%  1.67812s       999  1.6798ms  1.5447ms  2.0260ms  void thrust::binary_transform_kernel<double, double, int, get_indexYOYOYOYO>(long, double*, double*, int*, get_indexYOYOYOYO)
 46.58%  1.61758s       999  1.6192ms  1.6013ms  2.3312ms  void thrust::binary_transform_kernel<double, int, double, calc_likelihood_sumYOYOYOYO>(long, double*, int*, double*, calc_likelihood_sumYOYOYOYO)
  2.82%  98.062ms       999  98.160us  95.488us  474.85us  void thrust::for_each_kernel<int, ind_calcYOYOYOYO>(long, int*, ind_calcYOYOYOYO)
  0.80%  27.792ms       999  27.819us  27.520us  33.376us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=512, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=3>, unsigned long=512>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::scan_detail::inclusive_scan_n, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=1>, thrust::detail::normal_iterator<thrust::device_ptr<double>>, long, thrust::detail::normal_iterator<thrust::device_ptr<double>>, thrust::plus<double>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=3)
  0.66%  22.978ms      1998  11.500us  10.944us  14.304us  void thrust::binary_transform_kernel<double, int, double, randn_transformYOYOYOYO>(long, double*, int*, double*, randn_transformYOYOYOYO)
  0.16%  5.6591ms      1998  2.8320us  2.3360us  4.0320us  void thrust::reduce_kernel<double>(double*, double, int)
  0.12%  4.0914ms      2003  2.0420us     544ns  1.6879ms  [CUDA memcpy HtoD]
  0.11%  3.8269ms      1998  1.9150us  1.3440us  2.3680us  void thrust::binary_transform_kernel<double, int, double, update_coordsYOYOYOYO>(long, double*, int*, double*, update_coordsYOYOYOYO)
  0.11%  3.7829ms       999  3.7860us  3.6800us  4.5440us  void thrust::binary_transform_kernel<double, double, double, exp_transformYOYOYOYO>(long, double*, double*, double*, exp_transformYOYOYOYO)
  0.11%  3.7306ms      1998  1.8670us  1.6640us  3.4560us  void thrust::for_each_kernel<double, normalize_weightsYOYOYOYO>(long, double*, normalize_weightsYOYOYOYO)
  0.08%  2.6512ms       999  2.6530us  2.5600us  3.2960us  void thrust::for_each_kernel<double, update_uYOYOYOYO>(long, double*, update_uYOYOYOYO)
  0.04%  1.4836ms       999  1.4850us  1.4400us  2.8800us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::zip_iterator<thrust::tuple<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, long>, thrust::detail::normal_iterator<thrust::device_ptr<double>>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>, thrust::detail::wrapped_function<thrust::detail::unary_transform_functor<thrust::system::detail::generic::sequence_detail::sequence_functor<double>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.04%  1.4648ms      3999     366ns     256ns  7.8080us  [CUDA memcpy DtoH]
  0.04%  1.2520ms       999  1.2530us  1.1520us  1.5680us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::detail::normal_iterator<thrust::device_ptr<double>>, thrust::detail::wrapped_function<thrust::detail::device_generate_functor<thrust::detail::fill_functor<double>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.00%  16.352us         3  5.4500us  1.3120us  13.568us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::device_ptr<int>, thrust::detail::wrapped_function<thrust::detail::device_generate_functor<thrust::detail::fill_functor<int>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.00%  8.6720us         6  1.4450us  1.1200us  3.0720us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::device_ptr<double>, thrust::detail::wrapped_function<thrust::detail::device_generate_functor<thrust::detail::fill_functor<double>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.00%  1.4080us         1  1.4080us  1.4080us  1.4080us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::zip_iterator<thrust::tuple<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, long>, thrust::detail::normal_iterator<thrust::device_ptr<int>>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>, thrust::detail::wrapped_function<thrust::detail::unary_transform_functor<thrust::system::detail::generic::sequence_detail::sequence_functor<int>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)

==6591== API calls:
Time(%)      Time     Calls       Avg       Min       Max  Name
 59.28%  2.87025s     10989  261.19us  137.58us  2.8728ms  cudaGetDeviceProperties
 26.71%  1.29315s       999  1.2944ms  1.0363ms  3.9671ms  cudaMemcpy
 10.15%  491.42ms      2012  244.24us  3.0070us  481.60ms  cudaMalloc
  1.56%  75.714ms     15994  4.7330us  3.0630us  826.93us  cudaLaunch
  1.44%  69.535ms      5003  13.898us  2.0090us  1.7164ms  cudaMemcpyAsync
  0.31%  15.048ms     10030  1.5000us  1.3000us  15.938us  cudaFuncGetAttributes
  0.16%  7.9663ms     55954     142ns     106ns  215.01us  cudaSetupArgument
  0.16%  7.6410ms      2012  3.7970us  2.6750us  120.44us  cudaFree
  0.07%  3.1887ms     15994     199ns     114ns  205.74us  cudaConfigureCall
  0.05%  2.2044ms      3007     733ns     530ns  1.6640us  cudaEventCreateWithFlags
  0.04%  2.1597ms      8022     269ns     189ns  14.372us  cudaGetDevice
  0.04%  1.8510ms      3007     615ns     426ns  3.3480us  cudaEventRecord
  0.03%  1.6270ms      3007     541ns     397ns  1.0580us  cudaEventDestroy
  0.01%  272.05us        90  3.0220us      96ns  115.18us  cuDeviceGetAttribute
  0.00%  187.93us         1  187.93us  187.93us  187.93us  cuDeviceTotalMem
  0.00%  22.124us         1  22.124us  22.124us  22.124us  cuDeviceGetName
  0.00%  2.8050us        11     255ns     196ns     647ns  cudaDeviceGetAttribute
  0.00%  1.5650us         2     782ns     180ns  1.3850us  cuDeviceGetCount
  0.00%     286ns         2     143ns     105ns     181ns  cuDeviceGet
