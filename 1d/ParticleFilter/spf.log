==24215== NVPROF is profiling process 24215, command: ./thrust_particle_filter -x 128 -y 128 -z 1000 -np 10000
==24215== Profiling application: ./thrust_particle_filter -x 128 -y 128 -z 1000 -np 10000
==24215== Profiling result:
Time(%)      Time     Calls       Avg       Min       Max  Name
 78.04%  3.96023s       999  3.9642ms  3.3319ms  3.9848ms  void thrust::binary_transform_kernel<double, double, int, get_indexYOYOYOYO>(long, double*, double*, int*, get_indexYOYOYOYO)
 11.05%  560.69ms       999  561.25us  545.02us  595.71us  void thrust::binary_transform_kernel<double, int, double, calc_likelihood_sumYOYOYOYO>(long, double*, int*, double*, calc_likelihood_sumYOYOYOYO)
  8.00%  405.82ms       999  406.22us  396.19us  414.78us  void thrust::for_each_kernel<int, ind_calcYOYOYOYO>(long, int*, ind_calcYOYOYOYO)
  1.31%  66.464ms       999  66.530us  65.536us  67.520us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=512, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=3>, unsigned long=512>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::scan_detail::inclusive_scan_n, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=1>, thrust::detail::normal_iterator<thrust::device_ptr<double>>, long, thrust::detail::normal_iterator<thrust::device_ptr<double>>, thrust::plus<double>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=3)
  0.33%  16.756ms      1998  8.3860us  6.9120us  9.8240us  void thrust::binary_transform_kernel<double, int, double, randn_transformYOYOYOYO>(long, double*, int*, double*, randn_transformYOYOYOYO)
  0.30%  15.090ms      1998  7.5520us  6.4000us  8.8000us  void thrust::reduce_kernel<double>(double*, double, int)
  0.20%  10.135ms      2003  5.0590us     896ns  8.1912ms  [CUDA memcpy HtoD]
  0.18%  9.1751ms      3999  2.2940us  2.0480us  14.112us  [CUDA memcpy DtoH]
  0.15%  7.6981ms      1998  3.8520us  3.3600us  4.3520us  void thrust::for_each_kernel<double, normalize_weightsYOYOYOYO>(long, double*, normalize_weightsYOYOYOYO)
  0.15%  7.5833ms      1998  3.7950us  3.0720us  4.3520us  void thrust::binary_transform_kernel<double, int, double, update_coordsYOYOYOYO>(long, double*, int*, double*, update_coordsYOYOYOYO)
  0.09%  4.4092ms       999  4.4130us  4.1920us  4.6080us  void thrust::binary_transform_kernel<double, double, double, exp_transformYOYOYOYO>(long, double*, double*, double*, exp_transformYOYOYOYO)
  0.09%  4.3422ms       999  4.3460us  4.0320us  4.7680us  void thrust::for_each_kernel<double, update_uYOYOYOYO>(long, double*, update_uYOYOYOYO)
  0.06%  3.0124ms       999  3.0150us  2.8480us  3.2640us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::zip_iterator<thrust::tuple<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, long>, thrust::detail::normal_iterator<thrust::device_ptr<double>>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>, thrust::detail::wrapped_function<thrust::detail::unary_transform_functor<thrust::system::detail::generic::sequence_detail::sequence_functor<double>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.06%  2.9001ms       999  2.9030us  2.7520us  3.1040us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::detail::normal_iterator<thrust::device_ptr<double>>, thrust::detail::wrapped_function<thrust::detail::device_generate_functor<thrust::detail::fill_functor<double>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.00%  22.880us         3  7.6260us  2.8480us  16.928us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::device_ptr<int>, thrust::detail::wrapped_function<thrust::detail::device_generate_functor<thrust::detail::fill_functor<int>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.00%  16.096us         6  2.6820us  2.4320us  3.3600us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::device_ptr<double>, thrust::detail::wrapped_function<thrust::detail::device_generate_functor<thrust::detail::fill_functor<double>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.00%  3.1680us         1  3.1680us  3.1680us  3.1680us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::zip_iterator<thrust::tuple<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, long>, thrust::detail::normal_iterator<thrust::device_ptr<int>>, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>, thrust::detail::wrapped_function<thrust::detail::unary_transform_functor<thrust::system::detail::generic::sequence_detail::sequence_functor<int>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)

==24215== API calls:
Time(%)      Time     Calls       Avg       Min       Max  Name
 37.46%  3.69884s      2012  1.8384ms  5.7060us  3.68026s  cudaMalloc
 34.09%  3.36609s     10989  306.31us  275.10us  1.3527ms  cudaGetDeviceProperties
 23.84%  2.35396s       999  2.3563ms  43.740us  2.6228ms  cudaMemcpy
  2.41%  237.88ms     15994  14.873us  9.1490us  522.80us  cudaLaunch
  1.35%  133.11ms      5003  26.606us  4.8600us  9.0043ms  cudaMemcpyAsync
  0.27%  26.790ms     10030  2.6700us  2.1670us  507.31us  cudaFuncGetAttributes
  0.16%  15.822ms     55954     282ns     178ns  591.08us  cudaSetupArgument
  0.16%  15.702ms      2012  7.8030us  5.5360us  174.55us  cudaFree
  0.08%  7.8330ms     15994     489ns     307ns  15.813us  cudaConfigureCall
  0.05%  5.3261ms      3007  1.7710us  1.4570us  9.3970us  cudaEventCreateWithFlags
  0.04%  4.1735ms      8022     520ns     328ns  8.4170us  cudaGetDevice
  0.04%  3.6144ms      3007  1.2010us  1.0090us  12.945us  cudaEventRecord
  0.03%  3.3398ms      3007  1.1100us     869ns  6.7370us  cudaEventDestroy
  0.01%  981.93us       166  5.9150us     292ns  228.81us  cuDeviceGetAttribute
  0.00%  118.46us         2  59.230us  45.491us  72.970us  cuDeviceGetName
  0.00%  118.06us         2  59.029us  58.530us  59.529us  cuDeviceTotalMem
  0.00%  13.634us        11  1.2390us     713ns  5.1430us  cudaDeviceGetAttribute
  0.00%  9.6200us         2  4.8100us  2.2000us  7.4200us  cuDeviceGetCount
  0.00%  2.9220us         4     730ns     412ns     970ns  cuDeviceGet
