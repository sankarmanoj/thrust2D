==18177== NVPROF is profiling process 18177, command: ./test.o -x 128 -y 128 -z 1000 -np 100
==18177== Profiling application: ./test.o -x 128 -y 128 -z 1000 -np 100
==18177== Profiling result:
Time(%)      Time     Calls       Avg       Min       Max  Name
 81.61%  372.32ms       999  372.70us  310.39us  2.4287ms  likelihood_kernel(double*, double*, double*, double*, double*, int*, int*, double*, unsigned char*, double*, double*, int, int, int, int, int, int, int*, double*)
 12.88%  58.750ms       999  58.808us  49.673us  808.36us  normalize_weights_kernel(double*, int, double*, double*, double*, int*)
  3.99%  18.203ms       999  18.221us  1.9200us  32.037us  find_index_kernel(double*, double*, double*, double*, double*, double*, double*, int)
  1.22%  5.5814ms         5  1.1163ms     800ns  5.5781ms  [CUDA memcpy HtoD]
  0.30%  1.3536ms       999  1.3540us  1.1200us  4.4170us  sum_kernel(double*, int)
  0.00%  8.2250us         7  1.1750us     992ns  2.1440us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::device_ptr<double>, thrust::detail::wrapped_function<thrust::detail::device_generate_functor<thrust::detail::fill_functor<double>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.00%  2.9760us         1  2.9760us  2.9760us  2.9760us  void thrust::system::cuda::detail::bulk_::detail::launch_by_value<unsigned int=0, thrust::system::cuda::detail::bulk_::detail::cuda_task<thrust::system::cuda::detail::bulk_::parallel_group<thrust::system::cuda::detail::bulk_::concurrent_group<thrust::system::cuda::detail::bulk_::agent<unsigned long=1>, unsigned long=0>, unsigned long=0>, thrust::system::cuda::detail::bulk_::detail::closure<thrust::system::cuda::detail::for_each_n_detail::for_each_kernel, thrust::tuple<thrust::system::cuda::detail::bulk_::detail::cursor<unsigned int=0>, thrust::device_ptr<int>, thrust::detail::wrapped_function<thrust::detail::device_generate_functor<thrust::detail::fill_functor<int>>, void>, unsigned int, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type, thrust::null_type>>>>(unsigned long=1)
  0.00%  2.7850us         3     928ns     768ns  1.2160us  [CUDA memcpy DtoH]

==18177== API calls:
Time(%)      Time     Calls       Avg       Min       Max  Name
 54.93%  343.00ms      4004  85.664us  3.0160us  2.4299ms  cudaLaunch
 25.59%  159.77ms        13  12.290ms  3.7200us  158.98ms  cudaMalloc
 17.54%  109.54ms         1  109.54ms  109.54ms  109.54ms  cudaThreadSynchronize
  0.92%  5.7597ms         8  719.96us  4.2260us  5.6718ms  cudaMemcpyAsync
  0.77%  4.7887ms     34973     136ns     100ns  218.25us  cudaSetupArgument
  0.11%  682.88us      4004     170ns     125ns  9.1030us  cudaConfigureCall
  0.05%  330.81us        91  3.6350us     144ns  117.96us  cuDeviceGetAttribute
  0.04%  253.21us        13  19.477us  3.0400us  96.779us  cudaFree
  0.03%  201.92us         1  201.92us  201.92us  201.92us  cuDeviceTotalMem
  0.01%  48.397us        32  1.5120us  1.3440us  3.4590us  cudaFuncGetAttributes
  0.01%  47.364us         1  47.364us  47.364us  47.364us  cuDeviceGetName
  0.00%  7.3030us        24     304ns     204ns  1.1710us  cudaGetDevice
  0.00%  6.0850us         8     760ns     566ns  1.4060us  cudaEventCreateWithFlags
  0.00%  5.2990us         8     662ns     497ns  1.4620us  cudaEventRecord
  0.00%  4.3010us         8     537ns     395ns  1.0910us  cudaEventDestroy
  0.00%  3.6760us        11     334ns     209ns     864ns  cudaDeviceGetAttribute
  0.00%  2.8150us         3     938ns     209ns  2.1350us  cuDeviceGetCount
  0.00%  1.4790us         3     493ns     206ns     780ns  cuDeviceGet
